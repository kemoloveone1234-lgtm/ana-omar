<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ø§ Ø¹Ù…Ø± - Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .omar-header { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .story-card { transition: transform 0.2s; border-radius: 15px; overflow: hidden; }
        .story-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body>
    <div class="max-w-md mx-auto min-h-screen bg-white shadow-2xl flex flex-col">
        <header class="omar-header p-8 text-white text-center shadow-lg">
            <h1 class="text-3xl font-bold mb-2">ğŸ“š Ø¹Ø§Ù„Ù… Ø¹Ù…Ø± Ù„Ù„Ù‚ØµØµ</h1>
            <p id="userWelcome" class="text-blue-100 text-sm italic"></p>
        </header>

        <div id="adminArea" class="hidden p-6 bg-blue-50 border-b-2 border-blue-200">
            <h2 class="font-bold text-blue-800 mb-4 flex items-center gap-2">âœ¨ Ø¥Ø¶Ø§ÙØ© Ù‚ØµØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <input id="titleInput" type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚ØµØ©" class="w-full p-3 mb-3 border-2 border-blue-200 rounded-xl focus:outline-none focus:border-blue-500">
            <input id="priceInput" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø¬Ù†ÙŠÙ‡)" class="w-full p-3 mb-4 border-2 border-blue-200 rounded-xl">
            <button onclick="publishStory()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold shadow-lg active:scale-95 transition">Ù†Ø´Ø± Ø§Ù„Ø¢Ù† ğŸš€</button>
        </div>

        <main class="p-6 flex-grow">
            <div id="loginWall" class="text-center py-20">
                <div class="mb-6 text-5xl">ğŸ“–</div>
                <h3 class="text-xl font-bold text-gray-700 mb-4">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„ØªØµÙØ­ Ø§Ù„Ù‚ØµØµ</h3>
                <button onclick="signIn()" class="bg-white border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-full font-bold shadow hover:bg-gray-50 flex items-center justify-center gap-2 mx-auto">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="20"> Ø¯Ø®ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¬ÙˆØ¬Ù„
                </button>
            </div>

            <div id="list" class="space-y-6"></div>
        </main>

        <footer class="p-4 text-center text-gray-400 text-xs border-t">
            Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ø¹Ù…Ø± Â© 2026
        </footer>
    </div>

    <script>
        const config = {
            apiKey: "AIzaSyBn-8ER3jyhEx6Fm4bM6uG9-fIoikHrT_c",
            authDomain: "ana-omar-b0e6c.firebaseapp.com",
            projectId: "ana-omar-b0e6c",
            storageBucket: "ana-omar-b0e6c.firebasestorage.app",
            messagingSenderId: "781802661336",
            appId: "1:781802661336:web:25736ef0b6b27f15167ead"
        };
        firebase.initializeApp(config);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const boss = "kemoloveone1234@gmail.com";

        function signIn() {
            auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
        }

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('loginWall').classList.add('hidden');
                document.getElementById('userWelcome').innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ " + user.displayName;
                if(user.email === boss) document.getElementById('adminArea').classList.remove('hidden');
                fetchData();
            }
        });

        function publishStory() {
            const t = document.getElementById('titleInput').value;
            const p = document.getElementById('priceInput').value;
            if(!t || !p) return alert("Ø§Ù…Ø³Ø­ Ø§Ù„Ø®Ø§Ù†Ø§Øª ÙˆØ§ÙƒØªØ¨ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©");
            db.collection("stories").add({ t, p, date: Date.now() }).then(() => {
                document.getElementById('titleInput').value = "";
                document.getElementById('priceInput').value = "";
            });
        }

        function fetchData() {
            db.collection("stories").orderBy("date", "desc").onSnapshot(snap => {
                const list = document.getElementById('list');
                list.innerHTML = '';
                snap.forEach(doc => {
                    const data = doc.data();
                    const isBoss = auth.currentUser?.email === boss;
                    list.innerHTML += `
                        <div class="story-card bg-white p-5 shadow-md border-r-4 border-blue-500">
                            <h3 class="text-xl font-bold text-gray-800">${data.t}</h3>
                            <p class="text-blue-600 font-bold text-lg mt-2">${data.p} Ø¬.Ù…</p>
                            <div class="mt-4 flex gap-2">
                                <a href="https://wa.me/201063858006?text=Ø·Ù„Ø¨ Ù‚ØµØ©: ${data.t}" class="flex-grow bg-green-500 text-white text-center py-2 rounded-lg font-bold">Ø´Ø±Ø§Ø¡ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</a>
                                ${isBoss ? `<button onclick="removeItem('${doc.id}')" class="bg-red-50 text-red-500 px-4 rounded-lg border border-red-100 text-sm font-bold">Ø­Ø°Ù</button>` : ''}
                            </div>
                        </div>`;
                });
            });
        }

        function removeItem(id) {
            if(confirm("Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚ØµØ©ØŸ")) db.collection("stories").doc(id).delete();
        }
    </script>
</body>
</html>
