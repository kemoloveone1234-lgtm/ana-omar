<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ana-omar | Ø¹Ø§Ù„Ù… Ù‚ØµØµ Ø§Ù„Ø£Ø·ÙØ§Ù„</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&family=Noto+Sans+Arabic:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #ff9800;
            --secondary: #4CAF50;
            --bg: #fff7e6;
            --text: #333;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Noto Sans Arabic', sans-serif; background: var(--bg); color: var(--text); direction: rtl; overflow-x: hidden; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Splash Screen */
        #splash {
            position: fixed; inset: 0; background: var(--primary);
            color: #fff; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 9999;
            transition: opacity 0.8s ease;
        }
        #splash h1 { font-family: 'Cairo'; font-size: 35px; margin-bottom: 10px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ */
        .auth-container {
            max-width: 400px; margin: 60px auto; padding: 30px;
            background: #fff; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none; animation: fadeIn 0.5s;
        }
        .auth-container h3 { font-family: 'Cairo'; color: var(--primary); text-align: center; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 12px; border: 1px solid #ddd; font-family: inherit; }
        .main-btn { width: 100%; padding: 15px; border: none; background: var(--primary); color: #fff; border-radius: 15px; font-size: 18px; font-weight: bold; cursor: pointer; }

        /* Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        header { background: var(--primary); color: #fff; padding: 20px; text-align: center; border-radius: 0 0 40px 40px; }
        nav { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; padding: 15px; max-width: 600px; margin: auto; }
        nav button { padding: 10px 5px; border: none; background: #fff; color: var(--primary); border-radius: 15px; font-weight: bold; font-size: 12px; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.05); }
        nav button.active { background: var(--primary); color: #fff; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ù‚ØµØµ */
        section { display: none; padding: 20px; max-width: 700px; margin: auto; }
        section.active { display: block; }
        
        .story-card { background: #fff; border-radius: 25px; overflow: hidden; margin-bottom: 25px; box-shadow: 0 8px 15px rgba(0,0,0,0.05); }
        .story-card img { width: 100%; height: 250px; object-fit: cover; }
        .story-card-content { padding: 20px; text-align: center; }
        
        .stars { color: #ccc; margin: 10px 0; cursor: pointer; }
        .stars .active { color: var(--primary); }

        .btn-read { background: var(--secondary); color: #fff; border: none; padding: 10px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; }
        
        footer { text-align: center; padding: 30px; color: #888; font-size: 13px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash">
    <i class="fas fa-star" style="font-size: 60px; margin-bottom: 20px;"></i>
    <h1>Ø£Ù†Ø§ Ø¹Ù…Ø±</h1>
    <p>Ø¨ÙˆØ§Ø¨ØªÙƒ Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø®ÙŠØ§Ù„...</p>
</div>

<!-- Login/Register -->
<div id="login" class="auth-container">
    <h3>âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
    <input id="reg-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
    <input id="reg-email" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    <input id="reg-pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <input id="reg-pass2" type="password" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <button class="main-btn" onclick="registerUser()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- App Content -->
<div id="app" style="display:none">
    <header>
        <h2 style="margin:0; font-family:'Cairo';">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ <span id="user-name-display"></span> âœ¨</h2>
    </header>

    <nav>
        <button id="nav-edu" onclick="showSection('edu')">ØªØ¹Ù„ÙŠÙ…ÙŠØ©</button>
        <button id="nav-adv" onclick="showSection('adv')">Ù…ØºØ§Ù…Ø±Ø§Øª</button>
        <button id="nav-moral" onclick="showSection('moral')">Ù‡Ø§Ø¯ÙØ©</button>
        <button id="nav-admin" onclick="showSection('admin')">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    </nav>

    <section id="edu"></section>
    <section id="adv"></section>
    <section id="moral"></section>

    <section id="admin">
        <div style="background:#fff; padding:20px; border-radius:20px;">
            <h3 style="text-align:center; font-family:'Cairo';">Ø¥Ø¶Ø§ÙØ© Ù‚ØµØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <input id="story-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚ØµØ©">
            <textarea id="story-desc" placeholder="ÙˆØµÙ Ø§Ù„Ù‚ØµØ©..."></textarea>
            
            <label style="font-size:12px;">ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù:</label>
            <input type="file" id="story-img-file" accept="image/*">
            
            <label style="font-size:12px;">Ù…Ù„Ù Ø§Ù„Ù‚ØµØ© (PDF):</label>
            <input type="file" id="story-pdf-file" accept="application/pdf">
            
            <input id="story-price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡">
            
            <select id="story-type">
                <option value="edu">ØªØ¹Ù„ÙŠÙ…ÙŠØ©</option>
                <option value="adv">Ù…ØºØ§Ù…Ø±Ø§Øª</option>
                <option value="moral">Ù‡Ø§Ø¯ÙØ©</option>
            </select>
            <button class="main-btn" style="background:var(--secondary);" onclick="saveNewStory()">Ø­ÙØ¸ Ø§Ù„Ù‚ØµØ©</button>
        </div>
    </section>

    <footer>
        Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ù…Ø¤Ù„Ù Ù…Ø­Ù…Ø¯ ÙØªØ­ÙŠ Â©2026
    </footer>
</div>

<script>
    // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
    window.onload = () => {
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash').style.display = 'none';
                checkAuth();
            }, 800);
        }, 2500);
    };

    function checkAuth() {
        const user = JSON.parse(localStorage.getItem('user_data'));
        if (user) {
            document.getElementById('app').style.display = 'block';
            document.getElementById('user-name-display').innerText = user.name;
            showSection('edu');
        } else {
            document.getElementById('login').style.display = 'block';
        }
    }

    function registerUser() {
        const name = document.getElementById('reg-name').value;
        const pass = document.getElementById('reg-pass').value;
        const pass2 = document.getElementById('reg-pass2').value;

        if (!name || !pass) { alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"); return; }
        if (pass !== pass2) { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©"); return; }

        localStorage.setItem('user_data', JSON.stringify({ name: name }));
        location.reload();
    }

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚ØµØµ
    let stories = JSON.parse(localStorage.getItem('stories_list')) || [];

    function showSection(id) {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('nav-' + id).classList.add('active');
        renderStories();
    }

    async function saveNewStory() {
        const title = document.getElementById('story-title').value;
        const desc = document.getElementById('story-desc').value;
        const price = document.getElementById('story-price').value;
        const type = document.getElementById('story-type').value;
        const imgFile = document.getElementById('story-img-file').files[0];
        const pdfFile = document.getElementById('story-pdf-file').files[0];

        if (!title || !pdfFile) { alert("Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆÙ…Ù„Ù Ø§Ù„Ù€ PDF Ø¶Ø±ÙˆØ±ÙŠØ§Ù†"); return; }

        const imgData = imgFile ? await toBase64(imgFile) : 'https://via.placeholder.com/400x250';
        const pdfData = await toBase64(pdfFile);

        stories.push({
            id: Date.now(),
            title: title,
            desc: desc,
            price: price,
            type: type,
            img: imgData,
            pdf: pdfData,
            rate: 0
        });

        localStorage.setItem('stories_list', JSON.stringify(stories));
        alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!");
        showSection(type);
    }

    function renderStories() {
        const types = ['edu', 'adv', 'moral'];
        types.forEach(t => {
            const container = document.getElementById(t);
            if (!container) return;
            const filtered = stories.filter(s => s.type === t);
            
            container.innerHTML = `<h2 style="text-align:center; font-family:'Cairo';">${t === 'edu' ? 'Ù‚ØµØµ ØªØ¹Ù„ÙŠÙ…ÙŠØ©' : t === 'adv' ? 'Ù…ØºØ§Ù…Ø±Ø§Øª' : 'Ù‚ØµØµ Ù‡Ø§Ø¯ÙØ©'}</h2>`;
            
            filtered.forEach(s => {
                container.innerHTML += `
                    <div class="story-card">
                        <img src="${s.img}">
                        <div class="story-card-content">
                            <h4>${s.title}</h4>
                            <p style="font-size:14px; color:#666;">${s.desc}</p>
                            <div style="font-weight:bold; color:var(--secondary); margin-bottom:10px;">${s.price || 0} Ø¬Ù†ÙŠÙ‡</div>
                            <div class="stars">
                                ${[1,2,3,4,5].map(i => `<i class="fas fa-star ${i <= s.rate ? 'active' : ''}" onclick="updateRate(${s.id}, ${i})"></i>`).join('')}
                            </div>
                            <button class="btn-read" onclick="viewPDF('${s.pdf}')">ğŸ“– Ø§Ù‚Ø±Ø£ Ø§Ù„Ø¢Ù†</button>
                            <button onclick="deleteStory(${s.id})" style="border:none; background:none; color:red; margin-top:10px; display:block; width:100%; cursor:pointer;">Ø­Ø°Ù</button>
                        </div>
                    </div>
                `;
            });
        });
    }

    function viewPDF(data) {
        const win = window.open();
        win.document.write(`<iframe src="${data}" frameborder="0" style="width:100%; height:100vh;"></iframe>`);
    }

    function deleteStory(id) {
        if(confirm("Ø­Ø°Ù Ø§Ù„Ù‚ØµØ©ØŸ")) {
            stories = stories.filter(s => s.id !== id);
            localStorage.setItem('stories_list', JSON.stringify(stories));
            renderStories();
        }
    }

    function updateRate(id, val) {
        stories.find(s => s.id === id).rate = val;
        localStorage.setItem('stories_list', JSON.stringify(stories));
        renderStories();
    }

    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
    });
</script>

</body>
</html>
